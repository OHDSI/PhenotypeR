# Generated by OmopViewer 0.1.0.900
# Be careful editing this file

ui <- bslib::page_navbar(
  theme = bs_theme(bootswatch = "zephyr"),
  
   #minty pulse
  
  title = "PhenotypeR",
  bslib::nav_panel(
    title = "Background",
    icon = shiny::icon("disease"),
    OmopViewer::cardFromMd("background.md")
  ),
  bslib::nav_menu(
    title = "Database diagnostics",
    icon = shiny::icon("list"),
    bslib::nav_panel(
      title = "Snapshot",
      icon = shiny::icon("clipboard-list"),
          bslib::nav_panel(
            title = "Snapshot table",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_omop_snapshot_gt_17_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "summarise_omop_snapshot_gt_17_download", label = "Download")
                ),
                class = "text-end"
              ),
                gt::gt_output("summarise_omop_snapshot_gt_17")
            )
          )
    ),
    bslib::nav_panel(
      title = "Observation period",
      icon = shiny::icon("eye"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_observation_period_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_observation_period_grouping_observation_period_ordinal",
                label = "Observation period",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_observation_period_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_observation_period_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table observation period",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_observation_period_gt_15_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "summarise_observation_period_gt_15_download", label = "Download")
                ),
                class = "text-end"
              ),
                gt::gt_output("summarise_observation_period_gt_15")
            )
          ),
          bslib::nav_panel(
            title = "Plot observation period",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::numericInput(
                    inputId = "summarise_observation_period_ggplot2_16_download_width",
                    label = "Width",
                    value = 15
                  ),
                  shiny::numericInput(
                    inputId = "summarise_observation_period_ggplot2_16_download_height",
                    label = "Height",
                    value = 10
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_observation_period_ggplot2_16_download_units",
                    label = "Units",
                    selected = "cm",
                    choices = c("px", "cm", "inch"),
                    multiple = FALSE
                  ),
                  shiny::numericInput(
                    inputId = "summarise_observation_period_ggplot2_16_download_dpi",
                    label = "dpi",
                    value = 300
                  ),
                  shiny::downloadButton(outputId = "summarise_observation_period_ggplot2_16_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "summarise_observation_period_ggplot2_16_variableName",
                    label = "variableName",
                    selected = "number subjects",
                    multiple = ,
                    choices = c("number subjects", "records per person", "duration in days", "days to next observation period"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_observation_period_ggplot2_16_plotType",
                    label = "plotType",
                    selected = "barplot",
                    multiple = ,
                    choices = c("barplot", "boxplot", "densityplot"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_observation_period_ggplot2_16_facet",
                    label = "facet",
                    selected = NULL,
                    multiple = TRUE,
                    choices = c("cdm_name", "observation_period_ordinal"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  position = "right"
                ),
                shiny::plotOutput("summarise_observation_period_ggplot2_16")
              )
            )
          )
        )
      )
    )
  ),
  bslib::nav_menu(
    title = "Codelist diagnostics",
    icon = shiny::icon("list"),
    bslib::nav_panel(
      title = "Achilles code use",
      icon = shiny::icon("chart-column"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "achilles_code_use_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "achilles_code_use_grouping_codelist_name",
                label = "Codelist name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "achilles_code_use_grouping_domain_id",
                label = "Domain id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "achilles_code_use_grouping_standard_concept",
                label = "Standard concept",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "achilles_code_use_grouping_vocabulary_id",
                label = "Vocabulary id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "achilles_code_use_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "achilles_code_use_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table achilles code use",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "achilles_code_use_gt_14_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "achilles_code_use_gt_14_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("codelist_name", "domain_id", "standard_concept", "vocabulary_id", "variable_name", "variable_level"),
                      input_id = "achilles_code_use_gt_14_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = c("cdm_name", "estimate_name"),
                      input_id = "achilles_code_use_gt_14_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = NULL,
                      input_id = "achilles_code_use_gt_14_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = character(),
                      input_id = "achilles_code_use_gt_14_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("achilles_code_use_gt_14")
              )
            )
          )
        )
      )
    ),
    bslib::nav_panel(
      title = "Orphan codes",
      icon = shiny::icon("magnifying-glass-arrow-right"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "orphan_code_use_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "orphan_code_use_grouping_codelist_name",
                label = "Codelist name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "orphan_code_use_grouping_domain_id",
                label = "Domain id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "orphan_code_use_grouping_vocabulary_id",
                label = "Vocabulary id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "orphan_code_use_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "orphan_code_use_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table orphan codes",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "orphan_code_use_gt_11_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "orphan_code_use_gt_11_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("codelist_name", "domain_id", "standard_concept", "vocabulary_id", "variable_name", "variable_level"),
                      input_id = "orphan_code_use_gt_11_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = c("cdm_name", "estimate_name"),
                      input_id = "orphan_code_use_gt_11_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = NULL,
                      input_id = "orphan_code_use_gt_11_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = character(),
                      input_id = "orphan_code_use_gt_11_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("orphan_code_use_gt_11")
              )
            )
          )
        )
      )
    )
  ),
  bslib::nav_menu(
    title = "Cohort diagnostics",
    icon = shiny::icon("list"),
    bslib::nav_panel(
      title = "Cohort code use",
      icon = shiny::icon("chart-column"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "cohort_code_use_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "cohort_code_use_grouping_cohort_name",
                label = "Cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "cohort_code_use_grouping_domain_id",
                label = "Domain id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "cohort_code_use_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table cohort code use",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "cohort_code_use_gt_12_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "cohort_code_use_gt_12_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("cohort_name", "codelist_name", "source_concept_name", "source_concept_id", "domain_id", "variable_name", "variable_level"),
                      input_id = "cohort_code_use_gt_12_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = c("cdm_name", "estimate_name"),
                      input_id = "cohort_code_use_gt_12_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = NULL,
                      input_id = "cohort_code_use_gt_12_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = character(),
                      input_id = "cohort_code_use_gt_12_hide"
                    )
                  ),
                  shiny::checkboxInput(
                    inputId = "cohort_code_use_gt_12_timing",
                    label = "timing",
                    value = c(FALSE)
                  ),
                  position = "right"
                ),
                gt::gt_output("cohort_code_use_gt_12")
              )
            )
          )
        )
      )
    ),
    
    bslib::nav_panel(
      title = "Cohort characteristics",
      icon = shiny::icon("users-gear"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_grouping_cohort_name",
                label = "Cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_grouping_age_group",
                label = "Age group",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_grouping_sex",
                label = "Sex",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_grouping_table",
                label = "Table",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_grouping_window",
                label = "Window",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_grouping_value",
                label = "Value",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Estimates",
              shinyWidgets::pickerInput(
                inputId = "summarise_characteristics_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table cohort characteristics",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_characteristics_gt_7_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "summarise_characteristics_gt_7_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("age_group", "sex", "table", "window", "value", "variable_name", "variable_level", "estimate_name"),
                      input_id = "summarise_characteristics_gt_7_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = c("cdm_name", "cohort_name"),
                      input_id = "summarise_characteristics_gt_7_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = NULL,
                      input_id = "summarise_characteristics_gt_7_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = character(),
                      input_id = "summarise_characteristics_gt_7_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("summarise_characteristics_gt_7")
              )
            )
          ),
          bslib::nav_panel(
            title = "Plot characteristics",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::numericInput(
                    inputId = "summarise_characteristics_ggplot2_8_download_width",
                    label = "Width",
                    value = 15
                  ),
                  shiny::numericInput(
                    inputId = "summarise_characteristics_ggplot2_8_download_height",
                    label = "Height",
                    value = 10
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_characteristics_ggplot2_8_download_units",
                    label = "Units",
                    selected = "cm",
                    choices = c("px", "cm", "inch"),
                    multiple = FALSE
                  ),
                  shiny::numericInput(
                    inputId = "summarise_characteristics_ggplot2_8_download_dpi",
                    label = "dpi",
                    value = 300
                  ),
                  shiny::downloadButton(outputId = "summarise_characteristics_ggplot2_8_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "summarise_characteristics_ggplot2_8_plotType",
                    label = "plotType",
                    selected = NULL,
                    multiple = FALSE,
                    choices = c("boxplot", "barplot", "scatterplot"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_characteristics_ggplot2_8_facet",
                    label = "facet",
                    selected = NULL,
                    multiple = TRUE,
                    choices = c("cdm_name", "cohort_name", "age_group", "sex", "table", "window", "value", "variable_name", "variable_level", "estimate_name", "table_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_characteristics_ggplot2_8_colour",
                    label = "colour",
                    selected = NULL,
                    multiple = TRUE,
                    choices = c("cdm_name", "cohort_name", "age_group", "sex", "table", "window", "value", "variable_name", "variable_level", "estimate_name", "table_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  position = "right"
                ),
                shiny::plotOutput("summarise_characteristics_ggplot2_8")
              )
            )
          )
        )
      )
    ),
    bslib::nav_panel(
      title = "Cohort Attrition",
      icon = shiny::icon("layer-group"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_settings_table_name",
                label = "Table name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_settings_cohort_definition_id",
                label = "Cohort definition id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_settings_cdm_version",
                label = "Cdm version",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_settings_vocabulary_version",
                label = "Vocabulary version",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_grouping_cohort_name",
                label = "Cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_grouping_reason",
                label = "Reason",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_grouping_reason_id",
                label = "Reason id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Estimates",
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_attrition_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table cohort attrition",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_attrition_gt_3_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "summarise_cohort_attrition_gt_3_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = "reason",
                      input_id = "summarise_cohort_attrition_gt_3_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = "variable_name",
                      input_id = "summarise_cohort_attrition_gt_3_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = c("cdm_name", "cohort_name"),
                      input_id = "summarise_cohort_attrition_gt_3_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = c("variable_level", "reason_id", "estimate_name"),
                      input_id = "summarise_cohort_attrition_gt_3_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("summarise_cohort_attrition_gt_3")
              )
            )
          ),
          bslib::nav_panel(
            title = "Diagram",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::numericInput(
                    inputId = "summarise_cohort_attrition_grViz_4_download_width",
                    label = "Width (px)",
                    value = 15
                  ),
                  shiny::numericInput(
                    inputId = "summarise_cohort_attrition_grViz_4_download_height",
                    label = "Height (px)",
                    value = 10
                  ),
                  shiny::downloadButton(outputId = "summarise_cohort_attrition_grViz_4_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(,
                  position = "right"
                ),
                DiagrammeR::grVizOutput("summarise_cohort_attrition_grViz_4")
              )
            )
          )
        )
      )
    ),
    bslib::nav_panel(
      title = "Cohort overlap",
      icon = shiny::icon("circle-half-stroke"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_overlap_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_overlap_grouping_cohort_name_reference",
                label = "Cohort name reference",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_overlap_grouping_cohort_name_comparator",
                label = "Cohort name comparator",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_overlap_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Estimates",
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_overlap_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table cohort overlap",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_overlap_gt_1_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "summarise_cohort_overlap_gt_1_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("cohort_name_reference", "cohort_name_comparator", "estimate_name"),
                      input_id = "summarise_cohort_overlap_gt_1_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = "variable_name",
                      input_id = "summarise_cohort_overlap_gt_1_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = "cdm_name",
                      input_id = "summarise_cohort_overlap_gt_1_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = "variable_level",
                      input_id = "summarise_cohort_overlap_gt_1_hide"
                    )
                  ),
                  shiny::checkboxInput(
                    inputId = "summarise_cohort_overlap_gt_1_uniqueCombinations",
                    label = "uniqueCombinations",
                    value = c(TRUE)
                  ),
                  position = "right"
                ),
                gt::gt_output("summarise_cohort_overlap_gt_1")
              )
            )
          ),
          bslib::nav_panel(
            title = "Plot cohort overlap",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::numericInput(
                    inputId = "summarise_cohort_overlap_ggplot2_2_download_width",
                    label = "Width",
                    value = 15
                  ),
                  shiny::numericInput(
                    inputId = "summarise_cohort_overlap_ggplot2_2_download_height",
                    label = "Height",
                    value = 10
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_overlap_ggplot2_2_download_units",
                    label = "Units",
                    selected = "cm",
                    choices = c("px", "cm", "inch"),
                    multiple = FALSE
                  ),
                  shiny::numericInput(
                    inputId = "summarise_cohort_overlap_ggplot2_2_download_dpi",
                    label = "dpi",
                    value = 300
                  ),
                  shiny::downloadButton(outputId = "summarise_cohort_overlap_ggplot2_2_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_overlap_ggplot2_2_facet",
                    label = "facet",
                    selected = c("cdm_name", "cohort_name_reference"),
                    multiple = TRUE,
                    choices = c("cdm_name", "cohort_name_reference", "cohort_name_comparator", "variable_name", "variable_level", "estimate_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shiny::checkboxInput(
                    inputId = "summarise_cohort_overlap_ggplot2_2_uniqueCombinations",
                    label = "uniqueCombinations",
                    value = c(TRUE)
                  ),
                  position = "right"
                ),
                plotly::plotlyOutput("summarise_cohort_overlap_ggplot2_2")
              )
            )
          )
        )
      )
    ),
    bslib::nav_panel(
      title = "Cohort timing",
      icon = shiny::icon("chart-simple"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_timing_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_timing_grouping_cohort_name_reference",
                label = "Cohort name reference",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_timing_grouping_cohort_name_comparator",
                label = "Cohort name comparator",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_timing_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Estimates",
              shinyWidgets::pickerInput(
                inputId = "summarise_cohort_timing_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table cohort timing",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_timing_gt_5_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "summarise_cohort_timing_gt_5_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("cdm_name", "cohort_name_reference", "cohort_name_comparator", "variable_name", "estimate_name"),
                      input_id = "summarise_cohort_timing_gt_5_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = character(),
                      input_id = "summarise_cohort_timing_gt_5_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = NULL,
                      input_id = "summarise_cohort_timing_gt_5_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = "variable_level",
                      input_id = "summarise_cohort_timing_gt_5_hide"
                    )
                  ),
                  shiny::checkboxInput(
                    inputId = "summarise_cohort_timing_gt_5_uniqueCombinations",
                    label = "uniqueCombinations",
                    value = c(TRUE)
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_timing_gt_5_timeScale",
                    label = "timeScale",
                    selected = "days",
                    multiple = FALSE,
                    choices = c("days", "years"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  position = "right"
                ),
                gt::gt_output("summarise_cohort_timing_gt_5")
              )
            )
          ),
          bslib::nav_panel(
            title = "Plot cohort timing",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::numericInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_download_width",
                    label = "Width",
                    value = 15
                  ),
                  shiny::numericInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_download_height",
                    label = "Height",
                    value = 10
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_download_units",
                    label = "Units",
                    selected = "cm",
                    choices = c("px", "cm", "inch"),
                    multiple = FALSE
                  ),
                  shiny::numericInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_download_dpi",
                    label = "dpi",
                    value = 300
                  ),
                  shiny::downloadButton(outputId = "summarise_cohort_timing_ggplot2_6_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_plotType",
                    label = "plotType",
                    selected = "boxplot",
                    multiple = FALSE,
                    choices = c("boxplot", "density"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_timeScale",
                    label = "timeScale",
                    selected = "days",
                    multiple = FALSE,
                    choices = c("days", "years"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_facet",
                    label = "facet",
                    selected = c("cdm_name", "cohort_name_reference"),
                    multiple = TRUE,
                    choices = c("cdm_name", "cohort_name_reference", "cohort_name_comparator", "variable_name", "variable_level", "estimate_name", "restrict_to_first_entry"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_colour",
                    label = "colour",
                    selected = "cohort_name_comparator",
                    multiple = TRUE,
                    choices = c("cdm_name", "cohort_name_reference", "cohort_name_comparator", "variable_name", "variable_level", "estimate_name", "restrict_to_first_entry"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shiny::checkboxInput(
                    inputId = "summarise_cohort_timing_ggplot2_6_uniqueCombinations",
                    label = "uniqueCombinations",
                    value = c(TRUE)
                  ),
                  position = "right"
                ),
                shiny::plotOutput("summarise_cohort_timing_ggplot2_6")
              )
            )
          )
        )
      )
    )
  ),
  bslib::nav_menu(
    title = "Matched diagnostics",
    icon = shiny::icon("list"),
    bslib::nav_panel(
      title = "Large Scale Characteristics",
      icon = shiny::icon("arrow-up-right-dots"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_large_scale_characteristics_settings_table_name",
                label = "Table name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_large_scale_characteristics_settings_type",
                label = "Type",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_large_scale_characteristics_settings_analysis",
                label = "Analysis",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "summarise_large_scale_characteristics_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "summarise_large_scale_characteristics_grouping_cohort_name",
                label = "Cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Estimates",
              shinyWidgets::pickerInput(
                inputId = "summarise_large_scale_characteristics_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Tidy",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::downloadButton(outputId = "summarise_large_scale_characteristics_tidy_download", label = "Download csv")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "summarise_large_scale_characteristics_tidy_columns",
                    label = "Columns",
                    choices = NULL,
                    selected = NULL,
                    multiple = TRUE,
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shiny::radioButtons(
                    inputId = "summarise_large_scale_characteristics_tidy_pivot",
                    label = "Pivot estimates/variables",
                    choices = c("none", "estimates", "estimates and variables"),
                    selected = "none"
                  ),
                  position = "right"
                ),
                DT::dataTableOutput("summarise_large_scale_characteristics_tidy")
              )
            )
          ),
          bslib::nav_panel(
            title = "Formatted",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "summarise_large_scale_characteristics_gt_0_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "summarise_large_scale_characteristics_gt_0_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("concept_id", "variable_name", "variable_level", "estimate_name", "table_name", "type", "analysis"),
                      input_id = "summarise_large_scale_characteristics_gt_0_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = "cdm_name",
                      input_id = "summarise_large_scale_characteristics_gt_0_header"
                    ),
                    sortable::add_rank_list(
                      text = "group",
                      labels = "cohort_name",
                      input_id = "summarise_large_scale_characteristics_gt_0_group"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = character(),
                      input_id = "summarise_large_scale_characteristics_gt_0_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("summarise_large_scale_characteristics_gt_0")
              )
            )
          )
        )
      )
    )
  ),
  bslib::nav_menu(
    title = "Population diagnostics",
    icon = shiny::icon("list"),
    bslib::nav_panel(
      title = "Incidence",
      icon = shiny::icon("chart-line"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_analysis_outcome_washout",
                label = "Analysis outcome washout",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_analysis_repeated_events",
                label = "Analysis repeated events",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_analysis_interval",
                label = "Analysis interval",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_analysis_complete_database_intervals",
                label = "Analysis complete database intervals",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_denominator_age_group",
                label = "Denominator age group",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_denominator_sex",
                label = "Denominator sex",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_denominator_days_prior_observation",
                label = "Denominator days prior observation",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_denominator_start_date",
                label = "Denominator start date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_denominator_end_date",
                label = "Denominator end date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_denominator_target_cohort_name",
                label = "Denominator target cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_denominator_time_at_risk",
                label = "Denominator time at risk",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_settings_outcome_cohort_name",
                label = "Outcome cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "incidence_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_grouping_denominator_cohort_name",
                label = "Denominator cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_grouping_incidence_start_date",
                label = "Incidence start date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_grouping_incidence_end_date",
                label = "Incidence end date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table incidence",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "incidence_gt_18_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "incidence_gt_18_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("cdm_name", "denominator_cohort_name", "incidence_start_date", "incidence_end_date", "analysis_outcome_washout", "analysis_repeated_events", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "outcome_cohort_name", "variable_name", "variable_level"),
                      input_id = "incidence_gt_18_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = "estimate_name",
                      input_id = "incidence_gt_18_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = character(),
                      input_id = "incidence_gt_18_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = character(),
                      input_id = "incidence_gt_18_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("incidence_gt_18")
              )
            )
          ),
          bslib::nav_panel(
            title = "Plot incidence",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::numericInput(
                    inputId = "incidence_ggplot2_19_download_width",
                    label = "Width",
                    value = 15
                  ),
                  shiny::numericInput(
                    inputId = "incidence_ggplot2_19_download_height",
                    label = "Height",
                    value = 10
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "incidence_ggplot2_19_download_units",
                    label = "Units",
                    selected = "cm",
                    choices = c("px", "cm", "inch"),
                    multiple = FALSE
                  ),
                  shiny::numericInput(
                    inputId = "incidence_ggplot2_19_download_dpi",
                    label = "dpi",
                    value = 300
                  ),
                  shiny::downloadButton(outputId = "incidence_ggplot2_19_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "incidence_ggplot2_19_x",
                    label = "x",
                    selected = "incidence_start_date",
                    multiple = FALSE,
                    choices = c("cdm_name", "denominator_cohort_name", "incidence_start_date", "incidence_end_date", "analysis_outcome_washout", "analysis_repeated_events", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "outcome_cohort_name", "variable_name", "variable_level", "estimate_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shiny::checkboxInput(
                    inputId = "incidence_ggplot2_19_ribbon",
                    label = "ribbon",
                    value = c(FALSE)
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "incidence_ggplot2_19_facet",
                    label = "facet",
                    selected = NULL,
                    multiple = TRUE,
                    choices = c("cdm_name", "denominator_cohort_name", "incidence_start_date", "incidence_end_date", "analysis_outcome_washout", "analysis_repeated_events", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "outcome_cohort_name", "variable_name", "variable_level", "estimate_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "incidence_ggplot2_19_colour",
                    label = "colour",
                    selected = NULL,
                    multiple = TRUE,
                    choices = c("cdm_name", "denominator_cohort_name", "incidence_start_date", "incidence_end_date", "analysis_outcome_washout", "analysis_repeated_events", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "outcome_cohort_name", "variable_name", "variable_level", "estimate_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  position = "right"
                ),
                shiny::plotOutput("incidence_ggplot2_19")
              )
            )
          )
        )
      )
    ),
    bslib::nav_panel(
      title = "Incidence attrition",
      icon = shiny::icon("layer-group"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_analysis_outcome_washout",
                label = "Analysis outcome washout",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_analysis_repeated_events",
                label = "Analysis repeated events",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_analysis_interval",
                label = "Analysis interval",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_analysis_complete_database_intervals",
                label = "Analysis complete database intervals",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_denominator_age_group",
                label = "Denominator age group",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_denominator_sex",
                label = "Denominator sex",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_denominator_days_prior_observation",
                label = "Denominator days prior observation",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_denominator_start_date",
                label = "Denominator start date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_denominator_end_date",
                label = "Denominator end date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_denominator_target_cohort_name",
                label = "Denominator target cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_denominator_time_at_risk",
                label = "Denominator time at risk",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_settings_outcome_cohort_name",
                label = "Outcome cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_grouping_denominator_cohort_name",
                label = "Denominator cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_grouping_reason",
                label = "Reason",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_grouping_reason_id",
                label = "Reason id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Estimates",
              shinyWidgets::pickerInput(
                inputId = "incidence_attrition_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Table incidence attrition",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "incidence_attrition_gt_22_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "incidence_attrition_gt_22_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("denominator_cohort_name", "reason", "reason_id", "analysis_outcome_washout", "analysis_repeated_events", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "outcome_cohort_name"),
                      input_id = "incidence_attrition_gt_22_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = "variable_name",
                      input_id = "incidence_attrition_gt_22_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = c("cdm_name", "variable_level"),
                      input_id = "incidence_attrition_gt_22_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = "estimate_name",
                      input_id = "incidence_attrition_gt_22_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("incidence_attrition_gt_22")
              )
            )
          )
        )
      )
    ),
    bslib::nav_panel(
      title = "Prevalence",
      icon = shiny::icon("chart-line"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_analysis_interval",
                label = "Analysis interval",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_analysis_complete_database_intervals",
                label = "Analysis complete database intervals",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_denominator_age_group",
                label = "Denominator age group",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_denominator_sex",
                label = "Denominator sex",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_denominator_days_prior_observation",
                label = "Denominator days prior observation",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_denominator_start_date",
                label = "Denominator start date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_denominator_end_date",
                label = "Denominator end date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_denominator_target_cohort_name",
                label = "Denominator target cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_denominator_time_at_risk",
                label = "Denominator time at risk",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_analysis_type",
                label = "Analysis type",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_settings_analysis_full_contribution",
                label = "Analysis full contribution",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "prevalence_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_grouping_denominator_cohort_name",
                label = "Denominator cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_grouping_prevalence_start_date",
                label = "Prevalence start date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_grouping_prevalence_end_date",
                label = "Prevalence end date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Estimates",
              shinyWidgets::pickerInput(
                inputId = "prevalence_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Tidy",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::downloadButton(outputId = "prevalence_tidy_download", label = "Download csv")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_tidy_columns",
                    label = "Columns",
                    choices = NULL,
                    selected = NULL,
                    multiple = TRUE,
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shiny::radioButtons(
                    inputId = "prevalence_tidy_pivot",
                    label = "Pivot estimates/variables",
                    choices = c("none", "estimates", "estimates and variables"),
                    selected = "none"
                  ),
                  position = "right"
                ),
                DT::dataTableOutput("prevalence_tidy")
              )
            )
          ),
          bslib::nav_panel(
            title = "Table prevalence",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_gt_20_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "prevalence_gt_20_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("cdm_name", "denominator_cohort_name", "prevalence_start_date", "prevalence_end_date", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "analysis_type", "analysis_full_contribution", "variable_name", "variable_level"),
                      input_id = "prevalence_gt_20_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = "estimate_name",
                      input_id = "prevalence_gt_20_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = character(),
                      input_id = "prevalence_gt_20_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = character(),
                      input_id = "prevalence_gt_20_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("prevalence_gt_20")
              )
            )
          ),
          bslib::nav_panel(
            title = "Plot prevalence",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::numericInput(
                    inputId = "prevalence_ggplot2_21_download_width",
                    label = "Width",
                    value = 15
                  ),
                  shiny::numericInput(
                    inputId = "prevalence_ggplot2_21_download_height",
                    label = "Height",
                    value = 10
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_ggplot2_21_download_units",
                    label = "Units",
                    selected = "cm",
                    choices = c("px", "cm", "inch"),
                    multiple = FALSE
                  ),
                  shiny::numericInput(
                    inputId = "prevalence_ggplot2_21_download_dpi",
                    label = "dpi",
                    value = 300
                  ),
                  shiny::downloadButton(outputId = "prevalence_ggplot2_21_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_ggplot2_21_x",
                    label = "x",
                    selected = "prevalence_start_date",
                    multiple = FALSE,
                    choices = c("cdm_name", "denominator_cohort_name", "prevalence_start_date", "prevalence_end_date", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "analysis_type", "analysis_full_contribution", "variable_name", "variable_level", "estimate_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shiny::checkboxInput(
                    inputId = "prevalence_ggplot2_21_ribbon",
                    label = "ribbon",
                    value = c(FALSE)
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_ggplot2_21_facet",
                    label = "facet",
                    selected = NULL,
                    multiple = TRUE,
                    choices = c("cdm_name", "denominator_cohort_name", "prevalence_start_date", "prevalence_end_date", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "analysis_type", "analysis_full_contribution", "variable_name", "variable_level", "estimate_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_ggplot2_21_colour",
                    label = "colour",
                    selected = NULL,
                    multiple = TRUE,
                    choices = c("cdm_name", "denominator_cohort_name", "prevalence_start_date", "prevalence_end_date", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "analysis_type", "analysis_full_contribution", "variable_name", "variable_level", "estimate_name"),
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  position = "right"
                ),
                shiny::plotOutput("prevalence_ggplot2_21")
              )
            )
          )
        )
      )
    ),
    bslib::nav_panel(
      title = "Prevalence attrition",
      icon = shiny::icon("layer-group"),
      bslib::layout_sidebar(
        sidebar = bslib::sidebar(
          bslib::accordion(
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_analysis_interval",
                label = "Analysis interval",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_analysis_complete_database_intervals",
                label = "Analysis complete database intervals",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_denominator_age_group",
                label = "Denominator age group",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_denominator_sex",
                label = "Denominator sex",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_denominator_days_prior_observation",
                label = "Denominator days prior observation",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_denominator_start_date",
                label = "Denominator start date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_denominator_end_date",
                label = "Denominator end date",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_denominator_target_cohort_name",
                label = "Denominator target cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_denominator_time_at_risk",
                label = "Denominator time at risk",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_outcome_cohort_name",
                label = "Outcome cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_analysis_type",
                label = "Analysis type",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_settings_analysis_full_contribution",
                label = "Analysis full contribution",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            ),
            bslib::accordion_panel(
              title = "Settings",
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_grouping_cdm_name",
                label = "Database name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_grouping_denominator_cohort_name",
                label = "Denominator cohort name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_grouping_reason",
                label = "Reason",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_grouping_reason_id",
                label = "Reason id",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_variable_name",
                label = "Variable name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              ),
              shinyWidgets::pickerInput(
                inputId = "prevalence_attrition_estimate_name",
                label = "Estimate name",
                choices = NULL,
                selected = NULL,
                multiple = TRUE,
                options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
              )
            )
          )
        ),
        bslib::navset_card_tab(
          bslib::nav_panel(
            title = "Tidy",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shiny::downloadButton(outputId = "prevalence_attrition_tidy_download", label = "Download csv")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_attrition_tidy_columns",
                    label = "Columns",
                    choices = NULL,
                    selected = NULL,
                    multiple = TRUE,
                    options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                  ),
                  shiny::radioButtons(
                    inputId = "prevalence_attrition_tidy_pivot",
                    label = "Pivot estimates/variables",
                    choices = c("none", "estimates", "estimates and variables"),
                    selected = "none"
                  ),
                  position = "right"
                ),
                DT::dataTableOutput("prevalence_attrition_tidy")
              )
            )
          ),
          bslib::nav_panel(
            title = "Table prevalence attrition",
            bslib::card(
              full_screen = TRUE,
              bslib::card_header(
                bslib::popover(
                  shiny::icon("download"),
                  shinyWidgets::pickerInput(
                    inputId = "prevalence_attrition_gt_23_download_type",
                    label = "File type",
                    selected = "docx",
                    choices = c("docx", "png", "pdf", "html"),
                    multiple = FALSE
                  ),
                  shiny::downloadButton(outputId = "prevalence_attrition_gt_23_download", label = "Download")
                ),
                class = "text-end"
              ),
              bslib::layout_sidebar(
                sidebar = bslib::sidebar(
                  sortable::bucket_list(
                    header = NULL,
                    sortable::add_rank_list(
                      text = "none",
                      labels = c("denominator_cohort_name", "reason", "reason_id", "analysis_interval", "analysis_complete_database_intervals", "denominator_age_group", "denominator_sex", "denominator_days_prior_observation", "denominator_start_date", "denominator_end_date", "denominator_target_cohort_name", "denominator_time_at_risk", "outcome_cohort_name", "analysis_type", "analysis_full_contribution"),
                      input_id = "prevalence_attrition_gt_23_none"
                    ),
                    sortable::add_rank_list(
                      text = "header",
                      labels = "variable_name",
                      input_id = "prevalence_attrition_gt_23_header"
                    ),
                    sortable::add_rank_list(
                      text = "groupColumn",
                      labels = c("cdm_name", "variable_level"),
                      input_id = "prevalence_attrition_gt_23_groupColumn"
                    ),
                    sortable::add_rank_list(
                      text = "hide",
                      labels = "estimate_name",
                      input_id = "prevalence_attrition_gt_23_hide"
                    )
                  ),
                  position = "right"
                ),
                gt::gt_output("prevalence_attrition_gt_23")
              )
            )
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Summarise table",
    icon = shiny::icon(""),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Information",
            icon = shiny::icon("info"),
            shiny::p(character())
          ),
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_table_grouping_cdm_name",
              label = "Database name",
              choices = NULL,
              selected = NULL,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_table_grouping_sex",
              label = "Sex",
              choices = NULL,
              selected = NULL,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_table_variable_name",
              label = "Variable name",
              choices = NULL,
              selected = NULL,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_table_estimate_name",
              label = "Estimate name",
              choices = NULL,
              selected = NULL,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_table_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_table_tidy_columns",
                  label = "Columns",
                  choices = NULL,
                  selected = NULL,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_table_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_table_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Formatted",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_table_gt_0_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_table_gt_0_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("sex", "variable_name", "variable_level", "estimate_name"),
                    input_id = "summarise_table_gt_0_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = "cdm_name",
                    input_id = "summarise_table_gt_0_header"
                  ),
                  sortable::add_rank_list(
                    text = "group",
                    labels = character(),
                    input_id = "summarise_table_gt_0_group"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = character(),
                    input_id = "summarise_table_gt_0_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("summarise_table_gt_0")
            )
          )
        )
      )
    )
  ),
  bslib::nav_spacer(),
  bslib::nav_item(
    bslib::popover(
      shiny::icon("download"),
      shiny::downloadButton(
        outputId = "download_raw",
        label = "Download raw data",
        icon = shiny::icon("download")
      )
    )
  ),
  bslib::nav_item(
    bslib::popover(
      shiny::icon("circle-info"),
      shiny::tags$img(
        src = "hds_logo.svg",
        class = "logo-img",
        alt = "Logo",
        height = "auto",
        width = "30%",
        style = "float:right"
      ),
      "This shiny app was generated with ",
      shiny::a(
        "OmopViewer",
        href = "https://github.com/OHDSI/OmopViewer",
        target = "_blank"
      ),
      shiny::strong("v0.1.0.900")
    )
  ),
  bslib::nav_item(bslib::input_dark_mode(id = "dark_mode", mode = "light"))
)
